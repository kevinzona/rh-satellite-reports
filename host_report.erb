<%#
name: Host Report
snippet: false
template_inputs:
- name: hosts
  required: false
  input_type: user
  description: Limit the report only on hosts found by this search query. Keep empty
    for report on all available hosts.
  advanced: false
  value_type: search
  resource_type: Host
  hidden_value: false
- name: Output style
  required: false
  input_type: user
  description: Select 'Human-readable' to show statuses as they would appear in the
    web UI, or 'Machine-readable' to show numeric statuses.
  options: "Human-readable\r\nMachine-readable"
  advanced: false
  value_type: plain
  resource_type: Katello::ActivationKey
  default: Human-readable
  hidden_value: false
model: ReportTemplate
-%>
<%- report_headers 'Host ID', 'Name', 'IP','VIRT', 'Fact Output', 'VM HIST', 'CPU', 'CORES', 'SOCKETS', 'RAM' -%>
<%- load_hosts(search: input('hosts'), includes: :host_statuses).each_record do |host| -%>
<%-   report_row({
        'ID': host.id,
        'Name': host.name,
        'IP': host.ip,
        'VIRT': ( (JSON.parse(host.facts.to_json)["virt::is_guest"] == "true"  or JSON.parse(host.facts.to_json)["is_virtual"])? "VM" : "Physical"),
        'Fact Output': JSON.parse(host.facts.to_json.downcase)["virt::is_guest"],
        'VM HIST': host.hypervisor_host,
        'CPU': host.facts['cpu::cpu(s)'],
        'CORES': host.cores,
        'SOCKETS': host.sockets,
        'RAM': host.ram
      }) -%>
<%- end -%>
<%= report_render -%>
